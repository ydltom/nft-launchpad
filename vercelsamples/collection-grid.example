"use client"

import { useState } from "react"
import { Card, CardContent } from "@/components/ui/card"
import { Badge } from "@/components/ui/badge"
import { Button } from "@/components/ui/button"
import { Checkbox } from "@/components/ui/checkbox"
import { Users } from "lucide-react"
import Image from "next/image"
import { motion } from "framer-motion"

// Sample NFT collection data
const nftCollections = [
  {
    id: "cosmic-dreamers",
    name: "Cosmic Dreamers",
    description: "A journey through the digital cosmos, where dreams and reality merge.",
    image: "/placeholder.svg?height=400&width=400",
    artist: "Digital Nomad",
    price: "0.1 IMX",
    supply: "1,500",
    status: "active", // active, ended, upcoming
    ticketsSold: 342,
    endTime: new Date("2025-04-15T00:00:00Z").getTime(),
  },
  {
    id: "neon-horizon",
    name: "Neon Horizon",
    description: "The edge where digital and physical worlds collide in a burst of neon light.",
    image: "/placeholder.svg?height=400&width=400",
    artist: "Pixel Prophet",
    price: "0.1 IMX",
    supply: "1,500",
    status: "upcoming", // active, ended, upcoming
    ticketsSold: 0,
    endTime: new Date("2025-05-01T00:00:00Z").getTime(),
  },
  {
    id: "quantum-fragments",
    name: "Quantum Fragments",
    description: "Fragments of consciousness captured in the quantum realm.",
    image: "/placeholder.svg?height=400&width=400",
    artist: "Byte Artist",
    price: "0.1 IMX",
    supply: "1,500",
    status: "ended", // active, ended, upcoming
    ticketsSold: 1253,
    endTime: new Date("2025-03-15T00:00:00Z").getTime(),
  },
  {
    id: "digital-dreams",
    name: "Digital Dreams",
    description: "Explore the boundaries of imagination in the digital realm.",
    image: "/placeholder.svg?height=400&width=400",
    artist: "Tech Visionary",
    price: "0.15 IMX",
    supply: "1,000",
    status: "active", // active, ended, upcoming
    ticketsSold: 578,
    endTime: new Date("2025-04-20T00:00:00Z").getTime(),
  },
  {
    id: "cyber-punk",
    name: "Cyber Punk",
    description: "A dystopian future where technology and humanity merge.",
    image: "/placeholder.svg?height=400&width=400",
    artist: "Neon Artist",
    price: "0.12 IMX",
    supply: "2,000",
    status: "upcoming", // active, ended, upcoming
    ticketsSold: 0,
    endTime: new Date("2025-05-15T00:00:00Z").getTime(),
  },
  {
    id: "abstract-reality",
    name: "Abstract Reality",
    description: "Abstract art that challenges your perception of reality.",
    image: "/placeholder.svg?height=400&width=400",
    artist: "Mind Bender",
    price: "0.08 IMX",
    supply: "800",
    status: "ended", // active, ended, upcoming
    ticketsSold: 800,
    endTime: new Date("2025-03-01T00:00:00Z").getTime(),
  },
]

interface CollectionGridProps {
  account: string | null
  onSelectCollection: (collectionId: string) => void
}

export function CollectionGrid({ account, onSelectCollection }: CollectionGridProps) {
  // Filter state
  const [filters, setFilters] = useState({
    active: true,
    upcoming: true,
    ended: true,
  })

  // Get status badge based on collection status
  const getStatusBadge = (status: string) => {
    switch (status) {
      case "active":
        return <Badge className="bg-green-600">Active Raffle</Badge>
      case "upcoming":
        return <Badge className="bg-blue-600">Upcoming</Badge>
      case "ended":
        return <Badge className="bg-gray-600">Raffle Ended</Badge>
      default:
        return null
    }
  }

  // Filter collections based on selected filters
  const filteredCollections = nftCollections.filter((collection) => {
    if (collection.status === "active" && filters.active) return true
    if (collection.status === "upcoming" && filters.upcoming) return true
    if (collection.status === "ended" && filters.ended) return true
    return false
  })

  // Handle filter change
  const handleFilterChange = (filter: keyof typeof filters) => {
    setFilters((prev) => ({
      ...prev,
      [filter]: !prev[filter],
    }))
  }

  return (
    <div className="flex flex-col items-center">
      <h2 className="mb-4 text-center text-3xl font-bold">Available Collections</h2>

      {/* Filter Checkboxes */}
      <div className="mb-8 flex flex-wrap items-center justify-center gap-4 rounded-lg bg-gray-800/50 p-4 backdrop-blur-sm">
        <div className="mr-2 text-sm font-medium text-gray-300">Filter:</div>
        <div className="flex items-center space-x-2">
          <Checkbox
            id="filter-active"
            checked={filters.active}
            onCheckedChange={() => handleFilterChange("active")}
            className="border-green-500 data-[state=checked]:bg-green-600 data-[state=checked]:text-white"
          />
          <label
            htmlFor="filter-active"
            className="cursor-pointer text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
          >
            Active Raffles
          </label>
        </div>
        <div className="flex items-center space-x-2">
          <Checkbox
            id="filter-upcoming"
            checked={filters.upcoming}
            onCheckedChange={() => handleFilterChange("upcoming")}
            className="border-blue-500 data-[state=checked]:bg-blue-600 data-[state=checked]:text-white"
          />
          <label
            htmlFor="filter-upcoming"
            className="cursor-pointer text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
          >
            Upcoming
          </label>
        </div>
        <div className="flex items-center space-x-2">
          <Checkbox
            id="filter-ended"
            checked={filters.ended}
            onCheckedChange={() => handleFilterChange("ended")}
            className="border-gray-500 data-[state=checked]:bg-gray-600 data-[state=checked]:text-white"
          />
          <label
            htmlFor="filter-ended"
            className="cursor-pointer text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
          >
            Ended Raffles
          </label>
        </div>
      </div>

      {/* Grid layout for NFT collections */}
      <div className="grid w-full grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {filteredCollections.length > 0 ? (
          filteredCollections.map((collection) => (
            <motion.div
              key={collection.id}
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: -20 }}
              transition={{ duration: 0.3 }}
              layout
              className="card-hover-effect"
            >
              <Card className="overflow-hidden bg-gray-800 text-white">
                <div className="relative aspect-video">
                  <img
                    src={collection.image || "/placeholder.svg"}
                    alt={collection.name}
                    className="h-full w-full object-cover"
                  />
                  <div className="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent" />
                  <div className="absolute bottom-3 left-3 right-3">
                    <div className="flex items-center justify-between">
                      <h3 className="text-lg font-bold">{collection.name}</h3>
                      {getStatusBadge(collection.status)}
                    </div>
                    <p className="text-xs text-gray-300">by {collection.artist}</p>
                  </div>
                </div>

                <CardContent className="p-4">
                  <div className="mb-4 flex items-center justify-between">
                    <div className="flex items-center gap-1">
                      <div className="relative h-4 w-4">
                        <Image
                          src="/images/imx-logo.png"
                          alt="IMX"
                          width={16}
                          height={16}
                          className="h-full w-full object-contain"
                        />
                      </div>
                      <span className="text-xs font-medium">{collection.price}</span>
                    </div>
                    <div className="flex items-center gap-1">
                      <Users className="h-3 w-3 text-purple-400" />
                      <span className="text-xs text-gray-300">Supply: {collection.supply}</span>
                    </div>
                  </div>

                  <div className="mb-4">
                    <div className="h-1 w-full rounded-full bg-gray-700">
                      <div
                        className={`h-1 rounded-full ${
                          collection.status === "active"
                            ? "bg-gradient-to-r from-purple-500 to-pink-500"
                            : collection.status === "ended"
                              ? "bg-gray-500"
                              : "bg-blue-500"
                        }`}
                        style={{
                          width: `${
                            collection.status === "upcoming"
                              ? 0
                              : Math.min(
                                  100,
                                  (collection.ticketsSold / Number.parseInt(collection.supply.replace(/,/g, ""))) * 100,
                                )
                          }%`,
                        }}
                      />
                    </div>
                    <div className="mt-1 flex justify-between text-xs text-gray-400">
                      <span>
                        {collection.status === "upcoming" ? "Starts soon" : `${collection.ticketsSold} tickets sold`}
                      </span>
                      <span>{collection.supply} total</span>
                    </div>
                  </div>

                  <Button
                    onClick={() => onSelectCollection(collection.id)}
                    className={`w-full ${
                      collection.status === "active"
                        ? "bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700"
                        : collection.status === "upcoming"
                          ? "bg-blue-600 hover:bg-blue-700"
                          : "bg-gray-700 hover:bg-gray-600"
                    }`}
                    disabled={!account}
                  >
                    {collection.status === "active"
                      ? "Enter Raffle"
                      : collection.status === "upcoming"
                        ? "View Details"
                        : "View Results"}
                  </Button>
                </CardContent>
              </Card>
            </motion.div>
          ))
        ) : (
          <div className="col-span-full py-12 text-center">
            <p className="text-lg text-gray-400">No collections match your selected filters</p>
            <Button
              variant="outline"
              className="mt-4 border-purple-500 text-purple-400 hover:bg-purple-900/30"
              onClick={() => setFilters({ active: true, upcoming: true, ended: true })}
            >
              Reset Filters
            </Button>
          </div>
        )}
      </div>

      {!account && (
        <div className="mt-8 rounded-lg border border-gray-700 bg-gray-800/50 p-4 text-center text-gray-300">
          <p>Connect your wallet to enter raffles and view collection details</p>
        </div>
      )}
    </div>
  )
}
